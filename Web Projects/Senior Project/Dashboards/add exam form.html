<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
<title>add exam form</title>

<link rel="shortcut icon" href="assets/img/favicon.png">

<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;0,900;1,400;1,500;1,700&display=swap" rel="stylesheet">

<link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">

<link rel="stylesheet" href="assets/plugins/feather/feather.css">

<link rel="stylesheet" href="assets/plugins/icons/flags/flags.css">

<link rel="stylesheet" href="assets/plugins/fontawesome/css/fontawesome.min.css">
<link rel="stylesheet" href="assets/plugins/fontawesome/css/all.min.css">

<link rel="stylesheet" href="assets/plugins/select2/css/select2.min.css">

<link rel="stylesheet" href="assets/css/style.css">
</head>
<body>

<div class="main-wrapper">

<div class="header">

<div class="header-left">
<a href="index.html" class="logo">
<img src="assets/img/logo.pn" alt="Logo">
</a>
<a href="index.html" class="logo logo-small">
<img src="assets/img/logo-small.png" alt="Logo" width="30" height="30">
</a>
</div>

<div class="menu-toggle">
<a href="javascript:void(0);" id="toggle_btn">
<i class="fas fa-bars"></i>
</a>
</div>

<div class="top-nav-search">

</div>


<a class="mobile_btn" id="mobile_btn">
<i class="fas fa-bars"></i>
</a>


<ul class="nav user-menu">
<li class="nav-item dropdown language-drop me-2">
<a href="#" class="dropdown-toggle nav-link header-nav-list" data-bs-toggle="dropdown">
<img src="assets/img/icons/header-icon-01.svg" alt="">
</a>
<div class="dropdown-menu">
<a class="dropdown-item" href="javascript:;"><i class="flag flag-lr me-2"></i>English</a>
<a class="dropdown-item" href="javascript:;"><i class="flag flag-bl me-2"></i>Francais</a>
<a class="dropdown-item" href="javascript:;"><i class="flag flag-cn me-2"></i>Turkce</a>
</div>
</li>

<li class="nav-item dropdown noti-dropdown me-2">
<a href="#" class="dropdown-toggle nav-link header-nav-list" data-bs-toggle="dropdown">
<img src="assets/img/icons/header-icon-05.svg" alt="">
</a>
<div class="dropdown-menu notifications">
<div class="topnav-dropdown-header">
<span class="notification-title">Notifications</span>
<a href="javascript:void(0)" class="clear-noti"> Clear All </a>
</div>
<div class="noti-content">
<ul class="notification-list">
<li class="notification-message">
<a href="#">
<div class="media d-flex">
<span class="avatar avatar-sm flex-shrink-0">
<img class="avatar-img rounded-circle" alt="User Image" src="assets/img/profiles/avatar-02.jpg">
</span>
<div class="media-body flex-grow-1">
<p class="noti-details"><span class="noti-title">Carlson Tech</span> has approved <span class="noti-title">your estimate</span></p>
<p class="noti-time"><span class="notification-time">4 mins ago</span></p>
</div>
</div>
</a>
</li>
<li class="notification-message">
<a href="#">
<div class="media d-flex">
<span class="avatar avatar-sm flex-shrink-0">
<img class="avatar-img rounded-circle" alt="User Image" src="assets/img/profiles/avatar-11.jpg">
</span>
<div class="media-body flex-grow-1">
<p class="noti-details"><span class="noti-title">International Software Inc</span> has sent you a invoice in the amount of <span class="noti-title">$218</span></p>
<p class="noti-time"><span class="notification-time">6 mins ago</span></p>
</div>
</div>
</a>
</li>
<li class="notification-message">
<a href="#">
<div class="media d-flex">
<span class="avatar avatar-sm flex-shrink-0">
<img class="avatar-img rounded-circle" alt="User Image" src="assets/img/profiles/avatar-17.jpg">
</span>
<div class="media-body flex-grow-1">
<p class="noti-details"><span class="noti-title">John Hendry</span> sent a cancellation request <span class="noti-title">Apple iPhone XR</span></p>
<p class="noti-time"><span class="notification-time">8 mins ago</span></p>
</div>
</div>
</a>
</li>
<li class="notification-message">
<a href="#">
<div class="media d-flex">
<span class="avatar avatar-sm flex-shrink-0">
<img class="avatar-img rounded-circle" alt="User Image" src="assets/img/profiles/avatar-13.jpg">
</span>
<div class="media-body flex-grow-1">
<p class="noti-details"><span class="noti-title">Mercury Software Inc</span> added a new product <span class="noti-title">Apple MacBook Pro</span></p>
<p class="noti-time"><span class="notification-time">12 mins ago</span></p>
</div>
</div>
</a>
</li>
</ul>
</div>
<div class="topnav-dropdown-footer">
<a href="#">View all Notifications</a>
</div>
</div>
</li>

<li class="nav-item zoom-screen me-2">
<a href="#" class="nav-link header-nav-list">
<img src="assets/img/icons/header-icon-04.svg" alt="">
</a>
</li>

<li class="nav-item dropdown has-arrow new-user-menus">
<a href="#" class="dropdown-toggle nav-link" data-bs-toggle="dropdown">
<span class="user-img">
<img class="rounded-circle" src="assets/img/profiles/avatar-01.jpg" width="31" alt="Soeng Souy">
<div class="user-text">
<h6 id="loggedInUsername">Soeng Souy</h6>
<p class="text-muted mb-0" id="loggedInUserRole">Administrator</p>
</div>
</span>
</a>
<div class="dropdown-menu">
<div class="user-header">
<div class="avatar avatar-sm">
<img src="assets/img/profiles/avatar-01.jpg" alt="User Image" class="avatar-img rounded-circle">
</div>
<div class="user-text">
<h6 id="Fullname">Soeng Souy</h6>
<p class="text-muted mb-0" id="loggedInUserRoleDropdown">Administrator</p>
</div>
</div>
<a class="dropdown-item" href="profile.html">Profile</a>

<a class="dropdown-item" href="../login.html">Logout</a>
</div>
</li>

</ul>

</div>


<div class="sidebar" id="sidebar">
<div class="sidebar-inner slimscroll">
<div id="sidebar-menu" class="sidebar-menu">
<ul>
<li class="menu-title">
<span>Main Menu</span>
</li>
<li class="submenu">
<a href="#"><i class="feather-grid"></i> <span> Dashboard</span> <span class="menu-arrow"></span></a>
<ul>
<li><a href="teacher-dashboard.html">Teacher Dashboard</a></li>
</ul>
</li>


<li class="submenu">
    <a href="#"><i class="fas fa-graduation-cap"></i> <span> Courses</span> <span class="menu-arrow"></span></a>
    <ul>
    <li><a href="Course list.html">List Courses</a></li>
    <li><a href="add-course.html">Add course</a></li>
    <li><a href="edit-course.html">Edit courses</a></li>
    </ul>
    </li>

<li class="menu-title">
<span>Management</span>
</li>


<li>
<a href="exam.html"><i class="fas fa-clipboard-list"></i> <span>Exam list</span></a>
</li>



<ul>
<li class="submenu">
<a href="javascript:void(0);"> <span>Level 1</span> <span class="menu-arrow"></span></a>
<ul>
<li><a href="javascript:void(0);"><span>Level 2</span></a></li>
<li class="submenu">
<a href="javascript:void(0);"> <span> Level 2</span> <span class="menu-arrow"></span></a>
<ul>
<li><a href="javascript:void(0);">Level 3</a></li>
<li><a href="javascript:void(0);">Level 3</a></li>
</ul>
</li>
<li><a href="javascript:void(0);"> <span>Level 2</span></a></li>
</ul>
</li>
<li>
<a href="javascript:void(0);"> <span>Level 1</span></a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>


<div class="page-wrapper">
<div class="content container-fluid">

<div class="page-header">
<div class="row">
<div class="col">
<h3 class="page-title">Add Exam</h3>
<ul class="breadcrumb">
<li class="breadcrumb-item"><a href="index.html">Dashboard</a></li>
<li class="breadcrumb-item active">Add Exam</li>
</ul>
</div>
</div>
</div>

<div class="row">
<div class="col-lg-12">
<div class="card">
<div class="card-header">
<h5 class="card-title"></h5>
</div>
<div class="card-body">
<form action="add exam form.html" id="formPage2">
    <div class="form-group row">
        <label class="col-form-label col-md-2">Question</label>
        <div class="col-md-10">
        <textarea rows="5" cols="5" class="form-control" placeholder="Enter question here..." id="questionText"></textarea>
        </div>
        </div>
        <div class="form-group row">
            <label class="col-form-label col-md-2" id="Choice1">Choice 1</label>
            <div class="col-md-10">
            <input type="text" class="form-control">
            </div>
            </div>
            <div class="form-group row">
                <label class="col-form-label col-md-2" id="Choice2">Choice 2</label>
                <div class="col-md-10">
                <input type="text" class="form-control">
                </div>
                </div>
                <div class="form-group row">
                    <label class="col-form-label col-md-2" id="Choice3">Choice 3</label>
                    <div class="col-md-10">
                    <input type="text" class="form-control">
                    </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-form-label col-md-2" id="Choice4">Choice 4</label>
                        <div class="col-md-10">
                        <input type="text" class="form-control">
                        </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-form-label col-md-2" id="Choice5">Choice 5</label>
                            <div class="col-md-10">
                            <input type="text" class="form-control">
                            </div>
                            </div>
<div class="form-group row">
<label class="col-form-label col-md-2">Answer</label>
<div class="col-md-10">
<div class="radio">
<label>
<input type="radio" name="radio" id="Answer1"> Choice 1
</label>
<label>
    <input type="radio" name="radio" id="Answer2"> Choice 2
    </label>
    <label>
        <input type="radio" name="radio" id="Answer3"> Choice 3
        </label>
        <label>
            <input type="radio" name="radio" id="Answer4"> Option 5
            </label>
            <label>
                <input type="radio" name="radio" id="Answer5"> Choice 5
                </label>
</div>
<div class="radio">

</div>
<div class="radio">
</div>
</div>
</div>
<div class="form-group row">
    <label class="col-form-label col-md-2">Upload DOCX file</label>
    <div class="col-md-10">
    <input class="form-control" type="file" accept=".docx">
    </div>
    </div>
</div>
<div class="col-12">
    <button type="submit" id="nextQuestionBtn"  class="btn btn-primary" >Next Question</button>
</div>
</form>
</div>
</div>

<div class="card-body">
<form action="#" id="finishExamform">
    <div class="col-12">
        <button type="submit" id="finishExamBtn"  class="btn btn-primary" >Save Questions</button>
    </div>
</form>
<div class="col-12">
    <button type="submit" id="editQuestionsbtn"  class="btn btn-primary" >Edit Questions</button>
</div>
</div>
</div>
</div>
</div>
</div>


</div>

</div>
<script src="teacher-dashboard script.js"></script>
<script src="addexam script.js" defer></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const formPage2 = document.getElementById('formPage2');
    const questions = [];

    formPage2.addEventListener('submit', async function (event) {
        event.preventDefault();

        try {
            const questionText = document.getElementById('questionText').value;
            if (!questionText.trim()) {
                alert('Please enter a question.');
                return;
            }

            const choiceInputs = document.querySelectorAll('#formPage2 input[type="text"]');
            const choices = [];
            let emptyChoiceCount = 0;
            choiceInputs.forEach(input => {
                const choiceValue = input.value.trim();
                if (choiceValue === '') {
                    emptyChoiceCount++;
                }
                choices.push(choiceValue);
            });

            if (emptyChoiceCount === 5) {
                alert('Please fill at least one choice.');
                return;
            }

            const selectedAnswer = getSelectedAnswer();
            if (!selectedAnswer) {
                alert('Please select a correct answer.');
                return;
            }

            const answerIndex = parseInt(selectedAnswer.split(" ")[1]) - 1; // Extract the choice number from the selected answer
            if (choices[answerIndex] === '') {
                alert('The answer choice corresponding to the selected answer is empty.');
                return;
            }

            const questionData = {
                questionText: questionText,
                options: choices,
                correctAnswer: selectedAnswer
            };

            questions.push(questionData);
            console.log('Question Added:', questionData); // For error handling and logging

            clearFormFields();
        } catch (error) {
            console.error('Error in formPage2 submission:', error);
        }
    });

    function getSelectedAnswer() {
        const answerRadios = document.getElementsByName('radio');
        for (let i = 0; i < answerRadios.length; i++) {
            if (answerRadios[i].checked) {
                return answerRadios[i].nextSibling.nodeValue.trim();
            }
        }
        return '';
    }

    function clearFormFields() {
        document.getElementById('questionText').value = '';
        const choiceInputs = document.querySelectorAll('#formPage2 input[type="text"]');
        choiceInputs.forEach(input => input.value = '');
        const answerRadios = document.getElementsByName('radio');
        answerRadios.forEach(radio => radio.checked = false);
    }

    const finishExamBtn = document.getElementById('finishExamBtn');
    finishExamBtn.addEventListener('click', async function () {
        try {
            if (questions.length === 0) {
                alert('Please add at least one question.');
                return;
            }

            const completeExamData = {
                examName: localStorage.getItem('examName'),
                course: localStorage.getItem('course'),
                allottedTime: localStorage.getItem('allottedTime'),
                questions: questions
                // Add other data here if required
            };

            console.log('Complete Exam Data:', completeExamData); // For error handling and logging
            localStorage.setItem('displayQuestions', JSON.stringify(completeExamData.questions));

              // Redirect to the new endpoint for redirection
             
        
          
            // Sending the complete exam data to the server endpoint '/addExam'
            /*const response = await fetch('http://localhost:3000/addExam', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }, 
                body: JSON.stringify(completeExamData)
            });

            const data = await response.json();
            if (data.success) {
                console.log('Exam added successfully:', data.exam);
                // Redirect after successful exam addition
                window.location.href = "teacher-dashboard.html";
            } else {
                console.error('Error adding exam:', data.message);
            }*/
        } catch (error) {
            console.error('Error in finishExamBtn click:', error);
        }
    });
});
editQuestionsbtn.addEventListener('click', async function () {
    window.location.href = '../Display Qs/display.html'
    console.log('after redirect')
})

</script>

<script src="assets/js/jquery-3.6.0.min.js"></script>

<script src="assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>

<script src="assets/js/feather.min.js"></script>

<script src="assets/plugins/slimscroll/jquery.slimscroll.min.js"></script>

<script src="assets/plugins/select2/js/select2.min.js"></script>

<script src="assets/js/script.js"></script>
</body>
</html>